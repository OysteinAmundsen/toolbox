/**
 * Selection Plugin Styles
 *
 * Scoped to tbw-grid using CSS nesting for light DOM compatibility.
 */
@layer tbw-plugins {
  tbw-grid {
    /* Prevent text selection during range drag */
    &.selecting .data-grid-row > .cell {
      user-select: none;
    }

    /* Prevent text selection when any selection exists */
    &:has(.selection) {
      user-select: none;
    }

    /* Row selection - use accent color for row focus (only when grid is focused) */
    &[data-has-focus] .data-grid-row.row-focus {
      background-color: var(--tbw-focus-background, rgba(from var(--tbw-color-accent) r g b / 12%));
    }

    /* Disable cell-focus outline in row mode - row is the focus unit */
    &[data-selection-mode='row'] .cell-focus,
    &[data-selection-mode='range'] .cell-focus {
      outline: none;
    }

    /* Selection cell styles - for range mode */
    .data-grid-row > .cell.selected {
      background-color: var(--tbw-range-selection-bg);
      position: relative;

      /* Pseudo-element draws the selection range border inside the cell's
         padding box. Uses inset: 0 to stay within overflow: hidden bounds.
         The cell's own borders (row divider, column border) remain visible
         outside the selection border â€” this is intentional and consistent
         across all themes regardless of border width or visibility. */
      &::after {
        content: '';
        position: absolute;
        inset: 0;
        pointer-events: none;
        border: 0 solid var(--tbw-range-border-color);
        z-index: 1;
      }

      &.top::after {
        border-top-width: 2px;
      }
      &.bottom::after {
        border-bottom-width: 2px;
      }
      &.first::after {
        border-left-width: 2px;
      }
      &.last::after {
        border-right-width: 2px;
      }
    }

    /* Non-selectable row styling (row mode) */
    .data-grid-row[data-selectable='false'] {
      cursor: not-allowed;
      opacity: 0.6;

      /* Muted selection indicator */
      &.row-focus {
        background-color: var(--tbw-color-row-alt);
      }
    }

    /* Non-selectable cell styling (cell/range mode) */
    .data-grid-row > .cell[data-selectable='false'] {
      cursor: not-allowed;
      opacity: 0.6;

      /* Prevent selection highlight on non-selectable cells */
      &.selected {
        background-color: var(--tbw-selection-warning-bg, rgba(from var(--tbw-color-error) r g b / 50%));
      }
    }

    /* Selection summary in header */
    .tbw-selection-summary {
      font-size: var(--tbw-font-size-sm, 0.8125rem);
      color: var(--tbw-color-fg-muted);
      white-space: nowrap;
    }

    /* Checkbox column styles */
    .data-grid-row > .cell[data-field='__tbw_checkbox'] {
      text-align: center;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Row checkboxes are visual indicators - clicks pass through to cell */
    .tbw-select-row-checkbox {
      pointer-events: none;
      margin: 0;
      cursor: pointer;
    }

    /* Header select-all checkbox container */
    .tbw-checkbox-header {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
    }

    .tbw-select-all-checkbox {
      margin: 0;
      cursor: pointer;
    }
  }
} /* End @layer tbw-plugins */
