<div class="demo-container">
  <header class="demo-header">
    <div class="demo-controls">
      <label>
        <span class="row-count-display">
          Rows: <strong>{{ rowCount() }}</strong>
        </span>
        <input type="range" [(ngModel)]="rowCount" min="50" max="1000" step="50" />
      </label>
      <label>
        <input type="checkbox" [(ngModel)]="enableSelection" />
        Selection
      </label>
      <label>
        <input type="checkbox" [(ngModel)]="enableFiltering" />
        Filtering
      </label>
      <label>
        <input type="checkbox" [(ngModel)]="enableSorting" />
        Sorting
      </label>
      <label>
        <input type="checkbox" [(ngModel)]="enableEditing" />
        Editing
      </label>
      <label>
        <input type="checkbox" [(ngModel)]="enableMasterDetail" />
        Master-Detail
      </label>
    </div>
  </header>

  <div class="grid-wrapper">
    <tbw-grid
      #grid
      id="employee-grid"
      class="demo-grid"
      [rows]="rows()"
      [gridConfig]="gridConfig()"
      [customStyles]="customStyles"
      (cellCommit)="onCellCommit($event)"
    >
      <!-- Shell configuration with title -->
      <tbw-grid-header title="Employee Management System (Angular)"></tbw-grid-header>

      <!-- Toolbar buttons container -->
      <tbw-grid-tool-buttons>
        <button
          class="tbw-toolbar-btn"
          title="Export CSV"
          aria-label="Export CSV"
          (click)="exportCsv()"
        >
          ðŸ“„
        </button>
        <button
          class="tbw-toolbar-btn"
          title="Export Excel"
          aria-label="Export Excel"
          (click)="exportExcel()"
        >
          ðŸ“Š
        </button>
      </tbw-grid-tool-buttons>

      <!-- Column templates - column definitions come from gridConfig, these add Angular templates -->
      <!-- Using structural directives for cleaner syntax -->
      <!-- Auto-wiring: editor components just emit (commit) and (cancel) events, no explicit binding needed -->
      <tbw-grid-column field="status">
        <app-status-badge *tbwRenderer="let value" [value]="value" />
        <app-status-select-editor *tbwEditor="let value" [value]="value" />
      </tbw-grid-column>
      <tbw-grid-column field="bonus">
        <app-bonus-slider-editor
          *tbwEditor="let value; row as row"
          [value]="value"
          [salary]="row.salary"
        />
      </tbw-grid-column>
      <tbw-grid-column field="rating">
        <app-rating-display *tbwRenderer="let value" [value]="value" />
        <app-star-rating-editor *tbwEditor="let value" [value]="value" />
      </tbw-grid-column>
      <tbw-grid-column field="hireDate">
        <app-date-editor *tbwEditor="let value" [value]="value" />
      </tbw-grid-column>
      <tbw-grid-column field="isTopPerformer">
        <app-top-performer *tbwRenderer="let value" [value]="value" />
      </tbw-grid-column>

      <!-- Master-detail template -->
      @if (enableMasterDetail()) {
        <tbw-grid-detail [showExpandColumn]="true" animation="slide">
          <ng-template let-row>
            <app-detail-panel [employee]="row" />
          </ng-template>
        </tbw-grid-detail>
      }

      <!-- Custom Tool Panels -->
      <tbw-grid-tool-panel
        id="quick-filters"
        title="Quick Filters"
        icon="ðŸ”"
        tooltip="Apply quick filters to the data"
        [order]="10"
      >
        <ng-template let-grid>
          <app-quick-filters-panel [grid]="grid" />
        </ng-template>
      </tbw-grid-tool-panel>

      <tbw-grid-tool-panel
        id="analytics"
        title="Analytics"
        icon="ðŸ“ˆ"
        tooltip="View data analytics and insights"
        [order]="20"
      >
        <ng-template let-grid>
          <app-analytics-panel [grid]="grid" [rows]="rows()" />
        </ng-template>
      </tbw-grid-tool-panel>
    </tbw-grid>
  </div>
</div>
