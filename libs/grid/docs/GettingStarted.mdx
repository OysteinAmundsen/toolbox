{/* GettingStarted.mdx */}
import { Meta, Source } from '@storybook/addon-docs/blocks';
import { Tabs, Tab } from './components/Tabs';

<Meta title="Grid/Getting Started" />

# Getting Started

This guide walks you through setting up `@toolbox-web/grid` in your project.

## Installation

### Package Manager

```bash
# npm
npm install @toolbox-web/grid

# yarn
yarn add @toolbox-web/grid

# pnpm
pnpm add @toolbox-web/grid

# bun
bun add @toolbox-web/grid
```

### CDN (UMD)

For quick prototyping, you can use the UMD bundle directly:

```html
<script src="https://unpkg.com/@toolbox-web/grid/umd/grid.umd.js"></script>
```

## Basic Setup

### ES Modules (Recommended)

```typescript
// Import the component (registers <tbw-grid> custom element)
import '@toolbox-web/grid';

// TypeScript users: import types
import type { ColumnConfig, GridConfig } from '@toolbox-web/grid';
```

### HTML Markup

The grid is a standard web component. Use it like any HTML element:

```html
<tbw-grid id="my-grid" style="height: 400px;"></tbw-grid>
```

> **Important:** For virtualization to work, the grid needs a fixed height. Either set `height` via CSS/style or use `height: auto` for non-virtualized mode.

### Configuration via HTML Attributes

For simple use cases, configure the grid entirely via HTML attributes with JSON values:

```html
<tbw-grid
  style="height: 400px;"
  fit-mode="stretch"
  edit-on="dblClick"
  columns='[{"field":"id","header":"ID","type":"number"},{"field":"name","header":"Name","editable":true}]'
  rows='[{"id":1,"name":"Alice"},{"id":2,"name":"Bob"},{"id":3,"name":"Carol"}]'>
</tbw-grid>
```


### Declarative Configuration (Light DOM)

You can also configure columns declaratively:

```html
<tbw-grid>
  <tbw-grid-column field="id" header="ID" type="number" sortable></tbw-grid-column>
  <tbw-grid-column field="name" header="Name" editable></tbw-grid-column>
  <tbw-grid-column field="email" header="Email"></tbw-grid-column>
</tbw-grid>
```

### Auto-Inferred Columns

If no columns are configured, the grid will automatically infer column configuration from the first row:

```typescript
const grid = document.querySelector('#my-grid');

// Columns are auto-generated from object keys
grid.rows = [
  { id: 1, name: 'Alice Johnson', email: 'alice@example.com', active: true },
  { id: 2, name: 'Bob Smith', email: 'bob@example.com', active: false },
];
```
The grid will:
- Create a column for each property in the first row
- Infer column types from values (`number`, `boolean`, `date`, `string`)
- Use the property name as the header (with basic formatting)
- Apply appropriate built-in renderers for each type

Use `gridConfig` when you need to customize sorting, editing, plugins, or column appearance.

### Configuration via JavaScript

```typescript
const grid = document.querySelector('#my-grid');

// Configure grid with gridConfig
grid.gridConfig = {
  columns: [
    { field: 'id', header: 'ID', type: 'number', sortable: true },
    { field: 'name', header: 'Name', sortable: true, editable: true },
    { field: 'email', header: 'Email' },
    { field: 'active', header: 'Active', type: 'boolean' },
  ],
  fitMode: 'stretch', // Columns stretch to fill width
  editOn: 'dblClick', // Double-click to edit
  plugins: [],        // Add plugins here
};

// Set row data
grid.rows = [
  { id: 1, name: 'Alice Johnson', email: 'alice@example.com', active: true },
  { id: 2, name: 'Bob Smith', email: 'bob@example.com', active: false },
  { id: 3, name: 'Carol White', email: 'carol@example.com', active: true },
];
```

> **Tip:** You can also set `grid.columns` directly as a shorthand for `gridConfig.columns`, but using `gridConfig` is more versatile as it includes columns, plugins, and behavioral settings in one place.

## Framework Integration

The examples above use vanilla JavaScript. Here's how to integrate the grid with popular frameworks:

<Tabs>
  <Tab label="React">

```tsx
import '@toolbox-web/grid';
import { useEffect, useRef } from 'react';
import type { DataGridElement } from '@toolbox-web/grid';

function MyGrid({ data }) {
  const gridRef = useRef<DataGridElement>(null);

  useEffect(() => {
    if (gridRef.current) {
      gridRef.current.gridConfig = {
        columns: [...],
        fitMode: 'stretch',
        editOn: 'dblClick',
      };
      gridRef.current.rows = data;
    }
  }, [data]);

  return <tbw-grid ref={gridRef} style={{ height: '400px' }} />;
}
```

  </Tab>
  <Tab label="Vue">

```vue
<template>
  <tbw-grid ref="gridRef" style="height: 400px" />
</template>

<script setup>
import '@toolbox-web/grid';
import { ref, onMounted, watch } from 'vue';

const gridRef = ref(null);
const props = defineProps(['data']);

onMounted(() => {
  gridRef.value.gridConfig = {
    columns: [...],
    fitMode: 'stretch',
    editOn: 'dblClick',
  };
  gridRef.value.rows = props.data;
});

watch(
  () => props.data,
  (newData) => {
    gridRef.value.rows = newData;
  },
);
</script>
```

  </Tab>
  <Tab label="Angular">

For Angular projects, use the `@toolbox-web/grid-angular` adapter package for enhanced integration:

```bash
# Install both packages
npm install @toolbox-web/grid @toolbox-web/grid-angular
```

```typescript
// grid.component.ts
import '@toolbox-web/grid';
import { Component, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import { Grid, GridColumnView, GridColumnEditor } from '@toolbox-web/grid-angular';

@Component({
  selector: 'app-grid',
  imports: [Grid, GridColumnView, GridColumnEditor],
  schemas: [CUSTOM_ELEMENTS_SCHEMA],
  template: `
    <tbw-grid
      [rows]="rows"
      [gridConfig]="config"
      style="height: 400px; display: block;">

      <!-- Custom cell renderer using Angular template -->
      <tbw-grid-column field="status">
        <tbw-grid-column-view>
          <ng-template let-value let-row="row">
            <span [class]="'badge badge--' + value">{{ value }}</span>
          </ng-template>
        </tbw-grid-column-view>
      </tbw-grid-column>
    </tbw-grid>
  `
})
export class GridComponent {
  rows = [...];
  config = {...};
}
```

The `Grid` directive automatically registers the Angular adapter, enabling:
- Template-driven cell renderers (`GridColumnView`)
- Template-driven cell editors (`GridColumnEditor`)
- Full Angular component support inside templates

See the [Angular adapter documentation](https://github.com/OysteinAmundsen/toolbox/tree/main/libs/grid-angular#readme) for complete API reference.

### Basic Usage (Without Adapter)

For simple use cases without custom renderers, you can still use the grid directly:

```typescript
// grid.component.ts
import { Component, ElementRef, viewChild, effect, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import '@toolbox-web/grid';
import type { DataGridElement } from '@toolbox-web/grid';

@Component({
  selector: 'app-grid',
  schemas: [CUSTOM_ELEMENTS_SCHEMA],
  template: `<tbw-grid #grid style="height: 400px; display: block;"></tbw-grid>`,
})
export class GridComponent {
  gridRef = viewChild.required<ElementRef<DataGridElement>>('grid');

  constructor() {
    effect(() => {
      const grid = this.gridRef().nativeElement;
      grid.gridConfig = {
        columns: [...],
        fitMode: 'stretch',
        editOn: 'dblClick',
      };
      grid.rows = [...];
    });
  }
}
```

  </Tab>
</Tabs>

## TypeScript Support

The package includes full TypeScript definitions. Import types for better IDE support:

```typescript
import '@toolbox-web/grid';
import type { ColumnConfig, GridConfig, CellCommitDetail, SortChangeDetail } from '@toolbox-web/grid';

// Type-safe column configuration
const columns: ColumnConfig[] = [
  { field: 'id', header: 'ID', type: 'number' },
  { field: 'name', header: 'Name', editable: true },
];

// Type-safe event handling
grid.addEventListener('cell-commit', (e: CustomEvent<CellCommitDetail>) => {
  const { row, field, value, oldValue } = e.detail;
  console.log(`Changed ${field} from ${oldValue} to ${value}`);
});
```

## Next Steps

Now that you have the grid set up, explore:

- **[Core Features](../?path=/docs/grid-core--docs)** - Sorting, editing, keyboard navigation
- **[Plugins](../?path=/docs/grid-plugins-selection--docs)** - Add selection, filtering, row grouping
- **[Theming](../?path=/docs/grid-theming--docs)** - Customize colors and styles
- **[API Reference](../?path=/docs/grid-api--docs)** - Complete property/method/event reference
