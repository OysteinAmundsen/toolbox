/**
 * Base Grid Element Styles
 *
 * Core styles for the tbw-grid element including layout fundamentals,
 * box-sizing, and root element properties.
 *
 * @layer tbw-base
 */

@layer tbw-base {
  tbw-grid {
    /* Inherit color-scheme from document to respect page's dark/light mode setting.
       The host page should set `color-scheme: light`, `color-scheme: dark`, or
       `color-scheme: light dark` on :root or an ancestor element. */
    color-scheme: inherit;

    position: relative;
    display: block;
    width: 100%;
    height: 100%;
    min-height: 0;
    contain: content;
    font-family: var(--tbw-font-family);
    font-size: var(--tbw-font-size);
    font-feature-settings: 'tnum', 'lnum'; /* tabular-nums, lining-nums */
    background: var(--tbw-color-bg);
    color: var(--tbw-color-fg);
    border: 1px solid var(--tbw-color-border);
    border-radius: var(--tbw-border-radius);
    overflow: clip;
    outline: none;

    /* Box sizing for all descendants */
    &,
    & * {
      box-sizing: border-box;
    }

    /* ========== Grid Root Layout ========== */

    .tbw-grid-root {
      position: relative; /* For loading overlay positioning */
      display: flex;
      flex-direction: column;
      height: 100%;

      &.has-shell {
        display: flex;
        flex-direction: column;
        height: 100%;
      }
      &:has(.selected) {
        user-select: none;
      }
    }

    .rows-body-wrapper {
      flex: 1;
      min-height: 0;
      display: flex;
      flex-direction: row;
      width: 100%;
      min-width: fit-content;
    }

    .rows-body {
      flex: 1;
      min-width: 0;
      min-height: 0;
      display: flex;
      flex-direction: column;
      overflow: visible;
    }

    .rows-container {
      display: flex;
      flex-direction: row;
      flex: 1;
      min-height: 0;
      overflow: visible;
    }

    .rows-viewport {
      flex: 1;
      min-width: 0;
      position: relative;
      display: block;
      overflow: clip;

      .rows {
        position: absolute;
        top: 0;
        left: 0;
        min-width: 100%;
        will-change: transform;
        z-index: var(--tbw-z-layer-rows, 1);
      }
    }

    /* ========== Faux Scrollbar ========== */

    .faux-vscroll {
      position: sticky;
      inset-inline-end: 0;
      flex-shrink: 0;
      width: auto;
      overflow-y: auto;
      overflow-x: hidden;
      z-index: var(--tbw-z-layer-header, 30);
    }

    .faux-vscroll-spacer {
      width: 1px;
    }

    /* ========== Focus Styling ========== */

    &[data-has-focus] {
      .cell-focus,
      .row-focus {
        outline: var(--tbw-focus-outline);
        outline-offset: var(--tbw-focus-outline-offset);
      }
    }

    /* ========== Sticky Columns ========== */

    .sticky-left,
    .sticky-right {
      position: sticky;
      z-index: 25;
    }

    .sticky-left {
      box-shadow: 1px 0 0 var(--tbw-color-border);
    }

    .sticky-right {
      box-shadow: -1px 0 0 var(--tbw-color-border);
    }
  }
}
