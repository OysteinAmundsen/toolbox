import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as TreeStories from './tree.stories';

<Meta of={TreeStories} />

# Tree Plugin

The Tree plugin displays hierarchical data with parent-child relationships.

## Installation

```ts
import { TreePlugin } from '@toolbox-web/grid/plugins/tree';
```

## Basic Usage

```ts
const grid = document.querySelector('tbw-grid');
grid.gridConfig = {
  columns: [{ field: 'name', header: 'Name' }],
  plugins: [
    new TreePlugin({
      childrenField: 'children',
    }),
  ],
};

grid.rows = [
  { id: 1, name: 'Documents', children: [{ id: 2, name: 'Work', children: [{ id: 3, name: 'Report.docx' }] }] },
];
```

## Demos

### Default Tree View

<Canvas of={TreeStories.Default} withToolbar />
<Controls of={TreeStories.Default} />

### Expanded by Default

<Canvas of={TreeStories.ExpandedByDefault} withToolbar />

### Wide Indentation

<Canvas of={TreeStories.WideIndentation} withToolbar />

## Configuration Options

| Option            | Type                         | Default      | Description                              |
| ----------------- | ---------------------------- | ------------ | ---------------------------------------- |
| `childrenField`   | `string`                     | `'children'` | Field containing child array             |
| `autoDetect`      | `boolean`                    | `true`       | Auto-detect tree structure               |
| `defaultExpanded` | `boolean`                    | `false`      | Expand all initially                     |
| `indentWidth`     | `number`                     | `20`         | Indent per level in pixels               |
| `showExpandIcons` | `boolean`                    | `true`       | Show expand/collapse icons               |
| `animation`       | `false \| 'slide' \| 'fade'` | `'slide'`    | Animation style for expanding/collapsing |

### Animation Options

The `animation` option controls how child nodes appear/disappear:

```ts
// Slide animation (default)
new TreePlugin({ animation: 'slide', ... });

// Fade animation
new TreePlugin({ animation: 'fade', ... });

// No animation
new TreePlugin({ animation: false, ... });
```

> **Note:** Animation respects the grid-level `animation.mode` setting.

## Programmatic API

```ts
const plugin = grid.getPlugin(TreePlugin);

plugin.expand(nodeId);
plugin.collapse(nodeId);
plugin.toggle(nodeId);
plugin.expandAll();
plugin.collapseAll();
const expanded = plugin.getExpandedNodes();
```
