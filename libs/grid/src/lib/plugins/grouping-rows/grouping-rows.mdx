import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as GroupingRowsStories from './grouping-rows.stories';

<Meta of={GroupingRowsStories} />

# Row Grouping Plugin

The Row Grouping plugin enables hierarchical grouping of rows with expand/collapse.

## Installation

```ts
import { GroupingRowsPlugin } from '@toolbox-web/grid/plugins/grouping-rows';
```

## Basic Usage

```ts
const grid = document.querySelector('tbw-grid');
grid.gridConfig = {
  columns: [...],
  plugins: [
    new GroupingRowsPlugin({
      groupOn: (row) => [row.department],
    }),
  ],
};
```

## Demos

### Default Grouping

<Canvas of={GroupingRowsStories.Default} withToolbar />
<Controls of={GroupingRowsStories.Default} />

### Expanded by Default

<Canvas of={GroupingRowsStories.ExpandedByDefault} withToolbar />

### Without Row Count

<Canvas of={GroupingRowsStories.NoRowCount} withToolbar />

## Configuration Options

| Option            | Type                         | Default   | Description                              |
| ----------------- | ---------------------------- | --------- | ---------------------------------------- |
| `groupOn`         | `function`                   | -         | Callback returning group path            |
| `defaultExpanded` | `boolean`                    | `false`   | Start expanded                           |
| `showRowCount`    | `boolean`                    | `true`    | Show count in header                     |
| `indentWidth`     | `number`                     | `20`      | Indent per level in pixels               |
| `fullWidth`       | `boolean`                    | `true`    | Group row spans full width               |
| `animation`       | `false \| 'slide' \| 'fade'` | `'slide'` | Animation style for expanding/collapsing |

### Animation Options

The `animation` option controls how grouped rows appear/disappear:

```ts
// Slide animation (default)
new GroupingRowsPlugin({ animation: 'slide', ... });

// Fade animation
new GroupingRowsPlugin({ animation: 'fade', ... });

// No animation
new GroupingRowsPlugin({ animation: false, ... });
```

> **Note:** Animation respects the grid-level `animation.mode` setting.

## Multi-Level Grouping

```ts
new RowGroupingPlugin({
  groupByFields: ['region', 'department', 'team'],
});
```

## Programmatic API

```ts
const plugin = grid.getPlugin(RowGroupingPlugin);

plugin.expandGroup(['Engineering']);
plugin.collapseGroup(['Engineering']);
plugin.expandAll();
plugin.collapseAll();
const isExpanded = plugin.isGroupExpanded(['Engineering']);
```
